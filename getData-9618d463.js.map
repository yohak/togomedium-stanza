{"version":3,"file":"getData-9618d463.js","sources":["../../../home/runner/work/togomedium-stanza/togomedium-stanza/shared/utils/getData.ts"],"sourcesContent":["import { Nullable } from \"yohak-tools\";\nimport { isArray } from \"yohak-tools/\";\nimport { ApiResponse, SimpleObject } from \"./types\";\n\nexport const getData = async <ResponseBody, Params extends SimpleObject = SimpleObject>(\n  url: string,\n  params: Params,\n  abortController?: AbortController\n): Promise<ApiResponse<ResponseBody>> => {\n  const response = await fetch(\n    url,\n    makeOptions(params, abortController ? abortController.signal : null)\n  );\n\n  if (response.status !== 200) {\n    return {\n      status: response.status,\n      message: response.statusText,\n      body: undefined,\n    };\n  }\n  const body: ResponseBody = await response.json();\n  return {\n    status: 200,\n    body,\n  };\n};\n\nexport const makeFormBody = (params: SimpleObject) => {\n  const formBody = Object.entries(params).map(\n    ([key, value]) => `${key}=${encodeURIComponent(isArray(value) ? value.join(\",\") : value)}`\n  );\n  return formBody.join(\"&\");\n};\n\nconst makeOptions = (params: SimpleObject, signal: Nullable<AbortSignal> = null): RequestInit => {\n  const body = makeFormBody(params);\n  return {\n    method: \"POST\",\n    mode: \"cors\",\n    body,\n    headers: {\n      Accept: \"application/json\",\n      \"Content-Type\": \"application/x-www-form-urlencoded\",\n    },\n    signal,\n  };\n};\n"],"names":["isArray"],"mappings":";;;AAIa,MAAA,OAAO,GAAG,CACrB,GAAW,EACX,MAAc,EACd,eAAiC,KACK,SAAA,CAAA,KAAA,CAAA,EAAA,KAAA,CAAA,EAAA,KAAA,CAAA,EAAA,aAAA;IACtC,MAAM,QAAQ,GAAG,MAAM,KAAK,CAC1B,GAAG,EACH,WAAW,CAAC,MAAM,EAAE,eAAe,GAAG,eAAe,CAAC,MAAM,GAAG,IAAI,CAAC,CACrE,CAAC;AAEF,IAAA,IAAI,QAAQ,CAAC,MAAM,KAAK,GAAG,EAAE;QAC3B,OAAO;YACL,MAAM,EAAE,QAAQ,CAAC,MAAM;YACvB,OAAO,EAAE,QAAQ,CAAC,UAAU;AAC5B,YAAA,IAAI,EAAE,SAAS;SAChB,CAAC;AACH,KAAA;AACD,IAAA,MAAM,IAAI,GAAiB,MAAM,QAAQ,CAAC,IAAI,EAAE,CAAC;IACjD,OAAO;AACL,QAAA,MAAM,EAAE,GAAG;QACX,IAAI;KACL,CAAC;AACJ,CAAC,EAAC;AAEW,MAAA,YAAY,GAAG,CAAC,MAAoB,KAAI;IACnD,MAAM,QAAQ,GAAG,MAAM,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,GAAG,CACzC,CAAC,CAAC,GAAG,EAAE,KAAK,CAAC,KAAK,CAAG,EAAA,GAAG,IAAI,kBAAkB,CAACA,YAAO,CAAC,KAAK,CAAC,GAAG,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,KAAK,CAAC,CAAE,CAAA,CAC3F,CAAC;AACF,IAAA,OAAO,QAAQ,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;AAC5B,EAAE;AAEF,MAAM,WAAW,GAAG,CAAC,MAAoB,EAAE,MAAgC,GAAA,IAAI,KAAiB;AAC9F,IAAA,MAAM,IAAI,GAAG,YAAY,CAAC,MAAM,CAAC,CAAC;IAClC,OAAO;AACL,QAAA,MAAM,EAAE,MAAM;AACd,QAAA,IAAI,EAAE,MAAM;QACZ,IAAI;AACJ,QAAA,OAAO,EAAE;AACP,YAAA,MAAM,EAAE,kBAAkB;AAC1B,YAAA,cAAc,EAAE,mCAAmC;AACpD,SAAA;QACD,MAAM;KACP,CAAC;AACJ,CAAC;;;;"}