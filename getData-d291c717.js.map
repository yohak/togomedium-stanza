{"version":3,"file":"getData-d291c717.js","sources":["../../../home/runner/work/togomedium-stanza/togomedium-stanza/utils/getData.ts"],"sourcesContent":["import { Nullable } from \"yohak-tools\";\nimport { isArray } from \"yohak-tools/\";\nimport { ApiResponse, SimpleObject } from \"./types\";\n\nexport const getData = async <ResponseBody, Params extends SimpleObject = SimpleObject>(\n  url: string,\n  params: Params,\n  abortController?: AbortController\n): Promise<ApiResponse<ResponseBody>> => {\n  const response = await fetch(\n    url,\n    makeOptions(params, abortController ? abortController.signal : null)\n  );\n\n  if (response.status !== 200) {\n    return {\n      status: response.status,\n      message: response.statusText,\n      body: undefined,\n    };\n  }\n  const body: ResponseBody = await response.json();\n  return {\n    status: 200,\n    body,\n  };\n};\n\nexport const makeFormBody = (params: SimpleObject) => {\n  const formBody = Object.entries(params).map(\n    ([key, value]) => `${key}=${encodeURIComponent(isArray(value) ? value.join(\",\") : value)}`\n  );\n  return formBody.join(\"&\");\n};\n\nconst makeOptions = (params: SimpleObject, signal: Nullable<AbortSignal> = null): RequestInit => {\n  const body = makeFormBody(params);\n  return {\n    method: \"POST\",\n    mode: \"cors\",\n    body,\n    headers: {\n      Accept: \"application/json\",\n      \"Content-Type\": \"application/x-www-form-urlencoded\",\n    },\n    signal,\n  };\n};\n"],"names":["isArray"],"mappings":";;;MAIa,OAAO,GAAG,CACrB,GAAW,EACX,MAAc,EACd,eAAiC;IAEjC,MAAM,QAAQ,GAAG,MAAM,KAAK,CAC1B,GAAG,EACH,WAAW,CAAC,MAAM,EAAE,eAAe,GAAG,eAAe,CAAC,MAAM,GAAG,IAAI,CAAC,CACrE,CAAC;IAEF,IAAI,QAAQ,CAAC,MAAM,KAAK,GAAG,EAAE;QAC3B,OAAO;YACL,MAAM,EAAE,QAAQ,CAAC,MAAM;YACvB,OAAO,EAAE,QAAQ,CAAC,UAAU;YAC5B,IAAI,EAAE,SAAS;SAChB,CAAC;KACH;IACD,MAAM,IAAI,GAAiB,MAAM,QAAQ,CAAC,IAAI,EAAE,CAAC;IACjD,OAAO;QACL,MAAM,EAAE,GAAG;QACX,IAAI;KACL,CAAC;AACJ,CAAC,EAAC;MAEW,YAAY,GAAG,CAAC,MAAoB;IAC/C,MAAM,QAAQ,GAAG,MAAM,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,GAAG,CACzC,CAAC,CAAC,GAAG,EAAE,KAAK,CAAC,KAAK,GAAG,GAAG,IAAI,kBAAkB,CAACA,YAAO,CAAC,KAAK,CAAC,GAAG,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,KAAK,CAAC,EAAE,CAC3F,CAAC;IACF,OAAO,QAAQ,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;AAC5B,EAAE;AAEF,MAAM,WAAW,GAAG,CAAC,MAAoB,EAAE,SAAgC,IAAI;IAC7E,MAAM,IAAI,GAAG,YAAY,CAAC,MAAM,CAAC,CAAC;IAClC,OAAO;QACL,MAAM,EAAE,MAAM;QACd,IAAI,EAAE,MAAM;QACZ,IAAI;QACJ,OAAO,EAAE;YACP,MAAM,EAAE,kBAAkB;YAC1B,cAAc,EAAE,mCAAmC;SACpD;QACD,MAAM;KACP,CAAC;AACJ,CAAC;;;;"}